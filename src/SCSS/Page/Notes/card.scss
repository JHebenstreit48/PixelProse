@use 'sass:color';
@use '@scss/Globals' as *;
// @use './mixins' as *;

.card {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;

  width: $notes-card-width-desktop;
  margin: $notes-card-margin;
  padding: $notes-card-padding;
  line-height: 2rem;
  border-radius: $notes-card-radius;
  box-sizing: border-box;

  position: relative;
  isolation: isolate;
  z-index: 1;
  overflow: hidden; /* clip veneers on very tall cards */

  /* Glass tokens (tweak to taste) */
  --glass-blur: 26px;
  --frost-top: 0.06;
  --frost-bot: 0.02;
  --tint-top: 0.006;
  --tint-bot: 0.012;

  /* Diagonal sheen tuning */
  --sheen-angle: 130deg;
  --sheen-alpha: 0.11;
  --sheen-soft: 26px;
  --sheen-start: 44%;
  --sheen-peak: 50%;
  --sheen-end: 56%;

  background:
    linear-gradient(180deg, rgba(255, 255, 255, var(--frost-top)), rgba(255, 255, 255, var(--frost-bot))),
    linear-gradient(180deg, rgba(18, 32, 112, var(--tint-top)), rgba(12, 22, 76, var(--tint-bot)));
  border: 1px solid rgba(255, 255, 255, 0.18);
  outline: 1px solid rgba(0, 255, 255, 0.18);
  outline-offset: -1px;

  backdrop-filter: blur(var(--glass-blur)) saturate(145%);
  -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(145%);

  box-shadow:
    0 28px 80px rgba(0, 0, 0, 0.55),
    0 0 26px rgba(0, 255, 255, 0.14),
    inset 0 1px 0 rgba(255, 255, 255, 0.3),
    inset 0 -1px 0 rgba(255, 255, 255, 0.05),
    #{$notes-card-inner},
    #{$notes-card-outer};

  /* --- Veneers behind content --- */
  &::after {
    content: '';
    position: absolute;
    left: -25%;
    top: -25%;
    width: 150%;
    height: 150%;
    border-radius: inherit;
    pointer-events: none;
    z-index: 0;

    background:
      linear-gradient(
        var(--sheen-angle),
        rgba(255, 255, 255, 0) var(--sheen-start),
        rgba(255, 255, 255, var(--sheen-alpha)) var(--sheen-peak),
        rgba(255, 255, 255, 0) var(--sheen-end)
      ),
      linear-gradient(145deg, rgba(255, 255, 255, 0.05), transparent 60%);
    background-repeat: no-repeat;
    background-size: cover, cover;

    filter: blur(var(--sheen-soft));
    mix-blend-mode: screen;
  }

  /* fine grain */
  &::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    pointer-events: none;
    opacity: 0.035;
    background-image: url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='120' height='120'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='2' stitchTiles='stitch'/></filter><rect width='120' height='120' filter='url(%23n)'/></svg>");
    background-size: 120px 120px;
    z-index: 0;
  }

  /* keep side gutters on long pages */
  padding-inline: 24px;

  /* Mobile */
  @include maxw($cellphone-portrait) {
    width: 23rem;
    margin-left: auto;
    margin-right: auto;
  }
}